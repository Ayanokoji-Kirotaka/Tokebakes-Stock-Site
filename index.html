<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#e98a38">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Toke Bakes Stock">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" type="image/webp" href="assets/logo.webp">
  <link rel="apple-touch-icon" href="assets/logo.webp">
  <title>Toke Bakes | Bakery Inventory & Sales</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app-shell" id="appShell">
    <aside class="sidebar" id="sidebar">
      <div class="brand-block">
        <div class="brand-logo-wrap">
          <img id="brandLogo" src="assets/logo.png" alt="Toke Bakes Logo">
          <div id="brandLogoFallback" class="brand-logo-fallback" aria-hidden="true">TB</div>
        </div>
        <div class="brand-copy">
          <h1>Toke Bakes</h1>
          <p>Stock App</p>
        </div>
      </div>

      <button id="newSheetBtn" class="btn btn-primary full-width">+ New Stock Sheet</button>

      <div class="sheet-list-header">
        <span>Stock Sheets</span>
      </div>
      <div id="sheetList" class="sheet-list" aria-label="Stock Sheets"></div>
    </aside>

    <div class="drawer-backdrop" id="drawerBackdrop"></div>

    <main class="main-content">
      <header class="top-bar">
        <div class="top-bar-left">
          <button id="sidebarToggleBtn" class="btn btn-icon" aria-label="Toggle Sidebar">☰</button>
          <div>
            <h2 id="activeSheetName">Stock Sheet</h2>
            <p id="activeSheetMeta"></p>
          </div>
        </div>
        <div class="top-bar-actions">
          <button id="renameSheetBtn" class="btn">Rename</button>
          <button id="deleteSheetBtn" class="btn btn-danger">Delete</button>
        </div>
      </header>

      <div id="statusMessage" class="status-message" role="status" aria-live="polite"></div>

      <nav class="tabs" aria-label="Main tabs">
        <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
        <button class="tab-btn" data-tab="inventory">Inventory</button>
        <button class="tab-btn" data-tab="sales">Sales Log</button>
      </nav>

      <section id="dashboardTab" class="tab-panel active">
        <div class="metrics-grid">
          <article class="metric-card">
            <p class="metric-label">Total Revenue</p>
            <p class="metric-value" data-metric="totalRevenue">₦0</p>
          </article>
          <article class="metric-card">
            <p class="metric-label">Total Production Cost</p>
            <p class="metric-value" data-metric="totalProductionCost">₦0</p>
          </article>
          <article class="metric-card" id="grossProfitCard">
            <p class="metric-label">Gross Profit</p>
            <p class="metric-value" data-metric="grossProfitTotal">₦0</p>
          </article>
          <article class="metric-card">
            <p class="metric-label">Total Items Sold</p>
            <p class="metric-value" data-metric="totalItemsSold">0</p>
          </article>
          <article class="metric-card">
            <p class="metric-label">Total Items Available</p>
            <p class="metric-value" data-metric="totalItemsAvailable">0</p>
          </article>
          <article class="metric-card">
            <p class="metric-label">Total Stock Value @ Cost</p>
            <p class="metric-value" data-metric="totalStockValueCost">₦0</p>
          </article>
        </div>

        <section class="system-check-card">
          <div>
            <h3>Run System Check</h3>
            <p>Validate totals, stock integrity, and invariant rules for the active sheet.</p>
          </div>
          <button id="runSystemCheckBtn" class="btn btn-primary">Run System Check</button>
        </section>
        <div id="systemCheckResult" class="system-check-result">No check run yet.</div>
      </section>

      <section id="inventoryTab" class="tab-panel">
        <form id="addProductForm" class="form-grid">
          <div class="field">
            <label for="productName">Item Name</label>
            <input type="text" id="productName" required maxlength="80" placeholder="e.g. Chocolate Croissant">
          </div>
          <div class="field">
            <label for="unitCost">Unit Cost (₦)</label>
            <input type="number" id="unitCost" min="0" step="0.01" required>
          </div>
          <div class="field">
            <label for="unitPrice">Unit Price (₦)</label>
            <input type="number" id="unitPrice" min="0" step="0.01" required>
          </div>
          <div class="field">
            <label for="openingStock">Opening Stock</label>
            <input type="number" id="openingStock" min="0" step="1" required>
          </div>
          <div class="field form-action">
            <label>&nbsp;</label>
            <button type="submit" class="btn btn-primary full-width">Add Product</button>
          </div>
        </form>

        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th>Item Name</th>
                <th>Unit Cost</th>
                <th>Unit Price</th>
                <th>Opening Stock</th>
                <th>Stock Out</th>
                <th>Stock Available</th>
                <th>Stock Value @ Cost</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="inventoryTableBody"></tbody>
          </table>
        </div>
      </section>

      <section id="salesTab" class="tab-panel">
        <form id="addSaleForm" class="form-grid sales-form">
          <div class="field">
            <label for="saleDate">Date</label>
            <input type="date" id="saleDate" required>
          </div>
          <div class="field">
            <label for="saleItem">Item</label>
            <select id="saleItem" required></select>
          </div>
          <div class="field">
            <label for="saleQty">Quantity Sold</label>
            <input type="number" id="saleQty" min="1" step="1" required>
          </div>
          <div class="field form-action">
            <label>&nbsp;</label>
            <button type="submit" class="btn btn-primary full-width">Add Sale</button>
          </div>
        </form>

        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Item</th>
                <th>Qty</th>
                <th>Revenue</th>
                <th>Total Production Cost</th>
                <th>Gross Profit</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="salesTableBody"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>
